#!/usr/bin/env bash
set -e -o pipefail

# Attach or create a kitty tab named the same as current directory.

tab_name=${1-$(basename "$PWD")}

if kitty @ focus-tab --match title:"$tab_name" 2>/dev/null; then
    exit 0
fi

if [[ -d "$PWD/.git" ]]; then
    kitty @ launch --type tab --tab-title "$tab_name" --cwd "$PWD" zsh --login --interactive -c "nvim '+Telescope find_files'"
else
    kitty @ launch --type tab --tab-title "$tab_name" --cwd "$PWD" zsh --login --interactive
fi
